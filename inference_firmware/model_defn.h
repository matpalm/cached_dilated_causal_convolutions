#pragma once
#include "left_shift_buffer.h"
#include "block.h"
#include "rolling_cache.h"
#include "regression.h"

LeftShiftBuffer left_shift_input_buffer(
    4,   // kernel size
    3);  // feature depth

float b0_c1_kernel[4*3*4] = {0.4229564666748047, 0.4068918824195862, 0.3515176475048065, 0.15008752048015594, 0.18366988003253937, 0.046916503459215164, 0.11687241494655609, -0.559812605381012, -0.2721024453639984, -0.06659860908985138, 0.2011776864528656, -0.9125561714172363, -0.01133241131901741, 0.3522048592567444, -0.10699610412120819, 0.06908207386732101, 0.5207313895225525, 0.3884042501449585, 0.4151826798915863, -0.2395452857017517, -0.08863506466150284, 0.06777962297201157, -0.41939976811408997, 0.2971612215042114, -0.21422159671783447, 0.30105888843536377, 0.5395916700363159, -0.4375647008419037, 0.3110928237438202, -0.05864706635475159, 0.009642132557928562, -0.48606741428375244, -0.19405512511730194, 0.1744907945394516, 0.33656954765319824, 0.7020195126533508, 0.05091668665409088, -0.010739095509052277, -0.15976835787296295, -0.34312665462493896, -0.1637890785932541, 0.2464255690574646, -0.042836397886276245, 0.249094620347023, 0.5325742363929749, -0.6537224650382996, 0.5117762088775635, 1.1308177709579468};
float b0_c1_bias[4] = {-0.2202596515417099, -0.06489446759223938, -0.15209822356700897, 0.17062602937221527};
float b0_c2_kernel[1*4*4] = {-0.3204329013824463, -0.07360179722309113, 0.8033880591392517, 0.8403691649436951, -0.4036465585231781, 0.6705089211463928, -0.40148812532424927, 0.4072372317314148, 0.7876052260398865, -0.9339527487754822, -0.008093670010566711, -0.3056197166442871, 1.2187927961349487, -0.15705199539661407, 0.7768495678901672, -1.0715054273605347};
float b0_c2_bias[4] = {0.37884262204170227, 0.07236090302467346, 0.05222673714160919, -0.1528107225894928};
Block block0(4, // kernel_size
             3, 4, // in_d, out_d
             b0_c1_kernel, b0_c1_bias, b0_c2_kernel, b0_c2_bias);

float b1_c1_kernel[4*4*4] = {0.046786531805992126, 0.013245712034404278, -0.46898072957992554, 0.2811696529388428, -0.027840368449687958, 0.05926435813307762, 0.40297526121139526, -0.0564679317176342, 0.46134811639785767, 0.04095842316746712, 0.2818528413772583, -0.01060139574110508, 0.23331300914287567, 0.3940041661262512, -0.0823228508234024, 0.0527997724711895, 0.27470698952674866, 0.11224620789289474, 0.010742847807705402, 0.14632338285446167, 0.4395957887172699, 0.23023593425750732, 0.365308552980423, -0.09987157583236694, -0.03746066242456436, -0.2788431644439697, 0.07056719064712524, 0.4424535036087036, -0.2739521563053131, -0.07830458879470825, 0.1735854148864746, 0.07734052836894989, 0.21539779007434845, 0.11905008554458618, -0.13638125360012054, 0.0342937670648098, -0.42422571778297424, -0.25291743874549866, -0.29324468970298767, 0.44704657793045044, 0.3932856023311615, 0.3485175371170044, 0.19621804356575012, -0.10612066090106964, 0.23301920294761658, 0.16427485644817352, -0.3853560984134674, 0.4508148431777954, 0.09454891830682755, 0.6915372014045715, 0.4044973850250244, -0.32455718517303467, 0.6079134941101074, -0.46787506341934204, -0.15254443883895874, 0.6060014963150024, 0.4895762801170349, -0.5001744627952576, 0.3475625813007355, 0.050842851400375366, 0.30849283933639526, 0.2015836387872696, 0.2414526343345642, 0.5657606720924377};
float b1_c1_bias[4] = {0.0036915477830916643, 0.1729397028684616, 0.2543641924858093, -0.050554025918245316};
float b1_c2_kernel[1*4*4] = {0.5259672999382019, -0.4255155324935913, -0.037623342126607895, -0.36846494674682617, -0.07347327470779419, -0.696130096912384, 0.01889408379793167, 1.0531883239746094, 0.5047165751457214, 0.023756563663482666, -1.190230131149292, 0.09202682226896286, -0.8574342727661133, -0.16857880353927612, 0.722428560256958, -0.008136168122291565};
float b1_c2_bias[4] = {0.14148202538490295, 0.0, -0.1666603833436966, 0.18003907799720764};
Block block1(4, // kernel_size
             4, 4, // in_d, out_d
             b1_c1_kernel, b1_c1_bias, b1_c2_kernel, b1_c2_bias);

float b2_c1_kernel[4*4*4] = {-0.07670323550701141, -0.16447247564792633, -0.14973029494285583, 0.22443637251853943, -0.11772269010543823, -0.01863160729408264, 0.2859044373035431, -0.39737194776535034, -0.15344785153865814, 0.03888772428035736, 0.2233685553073883, 0.33707067370414734, 0.21812789142131805, 0.32906395196914673, 0.30596479773521423, -0.15209804475307465, -0.08717331290245056, -0.1153688132762909, -0.21649841964244843, 0.5700944662094116, -0.39063793420791626, 0.034960389137268066, -0.30575087666511536, -0.10981124639511108, -0.6923832893371582, -0.16086940467357635, -0.011367828585207462, -0.3953484892845154, 0.05723873898386955, -0.4382895827293396, 0.5776464939117432, -0.004733239766210318, -0.171543151140213, -0.45033881068229675, -0.47245872020721436, 0.2180512696504593, -0.10738348960876465, 0.19186189770698547, 0.11978510022163391, 0.3118005096912384, -0.7971022129058838, -0.16835591197013855, -0.2993772029876709, 0.17680341005325317, 0.5488901734352112, 0.30058497190475464, 0.3816002607345581, -0.18919555842876434, 0.058522652834653854, 0.33391857147216797, -0.007798885460942984, -0.15802277624607086, 0.3596411645412445, 0.3209715783596039, -0.40549999475479126, 0.19830265641212463, -0.9463577270507812, -0.4493747651576996, -0.0052717081271111965, -1.3557090759277344, -0.4690714180469513, 0.31593629717826843, -0.4864104390144348, -0.20196382701396942};
float b2_c1_bias[4] = {0.024260351434350014, 0.39022529125213623, 0.10832372307777405, -0.09942933171987534};
float b2_c2_kernel[1*4*4] = {-0.23527954518795013, -0.1903620958328247, 1.4051814079284668, -3.337169885635376, 0.7997512817382812, -0.8082925081253052, 0.44560596346855164, -0.2750111222267151, -0.9370611310005188, -0.5055123567581177, 0.6741300225257874, 0.2396305501461029, 0.8771412372589111, -0.7272128462791443, 0.048659175634384155, 0.7115098834037781};
float b2_c2_bias[4] = {0.30368420481681824, 0.0, -0.031080050393939018, 0.1016382947564125};
Block block2(4, // kernel_size
             4, 4, // in_d, out_d
             b2_c1_kernel, b2_c1_bias, b2_c2_kernel, b2_c2_bias);

float b3_c1_kernel[4*4*8] = {0.051472969353199005, 0.020087486132979393, -0.07794103026390076, -0.04816264659166336, -0.2063666731119156, 0.09207672625780106, -0.0836457684636116, 0.0795852541923523, 0.05968195199966431, -0.3240755498409271, -0.22843557596206665, -0.2483072280883789, -0.1875162124633789, -0.13758552074432373, 0.027654647827148438, 0.13340985774993896, 0.1714983731508255, 0.04102430120110512, -0.1375318318605423, 0.19097264111042023, 0.13772213459014893, 0.049676552414894104, -0.035295795649290085, -0.02491518296301365, 0.6678014993667603, 0.05817544832825661, 0.20616894960403442, 0.08820056170225143, -0.23249348998069763, -0.0735335499048233, 0.004161032382398844, -0.07003316283226013, 0.17970210313796997, -0.18546251952648163, -0.10359366238117218, -0.5897259712219238, 0.016069544479250908, 0.1946190893650055, -0.5133768320083618, 0.18766231834888458, -0.038999080657958984, 0.2632812559604645, -0.1007017195224762, -0.1929589807987213, 0.16638001799583435, -0.08036738634109497, 0.20646420121192932, -0.34616050124168396, 0.23449747264385223, 0.013336215168237686, -0.21362613141536713, 0.09839271754026413, -0.28444841504096985, -0.02896443009376526, -0.2888173758983612, -0.10176733881235123, 0.0784413143992424, -0.04853479191660881, 0.3727816343307495, -0.8114457130432129, 0.11438950151205063, 0.1896842122077942, -0.30274757742881775, 0.18092437088489532, 0.4375840723514557, -0.0908653512597084, 0.666304886341095, 0.10524286329746246, -0.8059777021408081, 0.2662030756473541, 0.051252420991659164, 0.2172146439552307, 0.20881351828575134, -0.015936315059661865, 0.3481871783733368, 0.2270350158214569, -0.3339746594429016, 0.15623417496681213, 0.21713289618492126, -0.15963995456695557, 0.0383782722055912, 0.1345459520816803, 0.7844033241271973, 0.2955656051635742, -0.3691238462924957, 0.18281520903110504, 0.16357702016830444, 0.05669167637825012, 0.696005642414093, 0.14838090538978577, 0.19866082072257996, 0.2130797803401947, 0.5526853799819946, 0.8004770278930664, 0.3307490050792694, -0.13794898986816406, 0.2129552811384201, -0.8037012815475464, 0.05261678248643875, 0.3493993580341339, 1.1707847118377686, 0.020529281347990036, 0.30716174840927124, 0.1274653971195221, 0.281723290681839, -0.13791275024414062, -0.31931817531585693, 0.17802467942237854, 0.28277936577796936, 0.07873925566673279, -0.08989879488945007, 0.06747794151306152, -0.7468262314796448, 0.43591123819351196, -0.016419334337115288, -0.2426510602235794, 0.047215912491083145, -0.2636754810810089, -0.41912880539894104, -1.513136863708496, 0.5767369866371155, -0.9914085865020752, -0.6343950033187866, 3.2998623847961426, 1.2034496068954468, -2.5660345554351807, 1.2049099206924438, 1.649026870727539};
float b3_c1_bias[8] = {-0.31372734904289246, 0.16147902607917786, -0.22828705608844757, 0.05259741097688675, 0.16384290158748627, 0.16833028197288513, 0.5011886358261108, 0.3682169020175934};
float b3_c2_kernel[1*8*8] = {-2.348203659057617, 0.1691066473722458, 0.3102855682373047, 0.38450637459754944, 0.3371647596359253, 0.3161897361278534, 0.3260669708251953, -0.8393518328666687, 0.16672654449939728, -1.180389404296875, 0.2242097556591034, -0.7616593241691589, -1.1354799270629883, -0.19109587371349335, 0.29221615195274353, -0.22691938281059265, 0.21336321532726288, -0.256929874420166, -1.8585911989212036, -0.39865949749946594, 0.32881635427474976, 0.415219247341156, -0.6844877600669861, -0.8710309863090515, 0.5244498252868652, 0.756266176700592, -0.5279737710952759, 0.6131274104118347, 0.3433017134666443, 0.015024231746792793, -0.7949036359786987, 0.314985990524292, -1.179672360420227, 0.5678163170814514, 0.24506080150604248, 0.9691780209541321, 0.6656648516654968, 0.5066953897476196, 0.3247089385986328, 0.121672123670578, 0.4720735549926758, -0.2240520715713501, 0.18998000025749207, 0.7515050768852234, -0.3771357536315918, -0.27952712774276733, -0.09701011329889297, 0.7390137314796448, -0.7487002015113831, 0.7748252153396606, 0.72547847032547, 0.024498190730810165, -0.03416012227535248, 1.5893685817718506, 0.3923068344593048, -2.13525390625, -11.816105842590332, 0.5044450759887695, 0.4535846412181854, -0.09054413437843323, 0.9470582604408264, -0.020886799320578575, -1.0903410911560059, -0.012219092808663845};
float b3_c2_bias[8] = {0.04149709269404411, 0.249874547123909, -0.025403406471014023, 0.08989035338163376, 0.48166683316230774, 0.14925967156887054, 0.27175283432006836, 0.030377283692359924};
Block block3(4, // kernel_size
             4, 8, // in_d, out_d
             b3_c1_kernel, b3_c1_bias, b3_c2_kernel, b3_c2_bias);

float layer0_cache_buffer[4*4*4];
RollingCache layer0_cache(
  4, // depth
  4, // dilation
  4, // kernel size
  layer0_cache_buffer
);

float layer1_cache_buffer[4*16*4];
RollingCache layer1_cache(
  4, // depth
  16, // dilation
  4, // kernel size
  layer1_cache_buffer
);

float layer2_cache_buffer[4*64*4];
RollingCache layer2_cache(
  4, // depth
  64, // dilation
  4, // kernel size
  layer2_cache_buffer
);

float regression_weights[8*1] = {-1.781128168106079, 0.7995295524597168, 1.716429591178894, -0.6238880753517151, 0.8441929817199707, -0.6373463273048401, -1.087668776512146, -2.1165592670440674};
float regression_biases[1] = {0.2017572820186615};
Regression regression(
  8, // input_dim
  1, // output_dim
  regression_weights,
  regression_biases
);
